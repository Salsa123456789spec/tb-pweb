<div class="container mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Evaluasi Permohonan Jadwal</h1>

    <!-- Stats -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-yellow-100 p-6 rounded-lg shadow">
            <h2 class="text-xl font-bold text-yellow-800">Menunggu Permohonan</h2>
            <p class="text-3xl font-extrabold text-yellow-900"><%= komplain.menunggu %></p>
        </div>
        <div class="bg-green-100 p-6 rounded-lg shadow">
            <h2 class="text-xl font-bold text-green-800">Diterima</h2>
            <p class="text-3xl font-extrabold text-green-900"><%= komplain.diterima %></p>
        </div>
        <div class="bg-red-100 p-6 rounded-lg shadow">
            <h2 class="text-xl font-bold text-red-800">Ditolak</h2>
            <p class="text-3xl font-extrabold text-red-900"><%= komplain.ditolak %></p>
        </div>
    </div>

    <!-- Daftar Permohonan -->
    <div class="space-y-6">
        <% if (semuaKomplain.length > 0) { %>
            <% semuaKomplain.forEach((k, index) => { %>
                <div class="bg-white p-6 rounded-lg shadow-md border">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="font-bold text-lg text-gray-800">Permohonan #<%= k.id %></h3>
                            <p class="text-sm text-gray-600">
                                <%= k.jadwal.pendaftaran.user.name %> | <%= k.jadwal.pendaftaran.user.nim %>
                            </p>
                        </div>
                        <span class="text-xs font-semibold px-3 py-1 rounded-full
                            <%= k.status === 'menunggu' ? 'bg-yellow-200 text-yellow-800' : (k.status === 'diterima' ? 'bg-green-200 text-green-800' : 'bg-red-200 text-red-800') %>">
                            <%= k.status %>
                        </span>
                    </div>

                    <hr class="my-4">

                    <p class="mb-4 text-gray-700"><strong>Alasan:</strong> <%= k.alasan %></p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="font-semibold text-gray-500">JadWAL SEMULA</p>
                            <p><%= new Date(k.jadwal.tanggal).toLocaleDateString('id-ID', { dateStyle: 'full' }) %></p>
                            <p><%= new Date('1970-01-01T' + k.jadwal.waktu).toLocaleTimeString('id-ID', { timeStyle: 'short' }) %> WIB</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="font-semibold text-blue-800">JADWAL DIAJUKAN</p>
                            <p><%= new Date(k.tanggal_diajukan).toLocaleDateString('id-ID', { dateStyle: 'full' }) %></p>
                            <p><%= new Date(k.waktu_diajukan).toLocaleTimeString('id-ID', { timeStyle: 'short' }) %> WIB</p>
                        </div>
                    </div>
                    
                    <% if (k.status === 'menunggu') { %>
                        <div class="flex justify-end gap-4 mt-6">
                            <form action="/aslab/evaluasi-permohonan/<%= k.id %>" method="POST">
                                <input type="hidden" name="status" value="diterima">
                                <button type="submit" class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 transition-colors">
                                    Terima Permohonan
                                </button>
                            </form>
                            <form action="/aslab/evaluasi-permohonan/<%= k.id %>" method="POST">
                                <input type="hidden" name="status" value="ditolak">
                                <button type="submit" class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors">
                                    Tolak Permohonan
                                </button>
                            </form>
                        </div>
                    <% } %>
                </div>
            <% }) %>
        <% } else { %>
            <p class="text-center text-gray-500 py-10">Belum ada permohonan perubahan jadwal.</p>
        <% } %>
    </div>
</div> 