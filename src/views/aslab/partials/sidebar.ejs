<aside class="w-64 min-h-screen bg-gradient-to-b from-green-700 to-green-900 text-white shadow-md">
  <div class="p-6 text-xl font-bold">LeasCalling</div>
  <nav class="px-4 space-y-1">

    <!-- Dashboard -->
    <a href="/aslab/dashboard"
       class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition
       <%= activePage === 'dashboard' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
      <span class="material-icons mr-2">dashboard</span>
      Dashboard
    </a>

    <!-- Verifikasi Berkas -->
    <a href="/aslab/verifikasi"
       class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition
       <%= activePage === 'verifikasi' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
      <span class="material-icons mr-2">verified_user</span>
      Verifikasi Berkas
    </a>

     <!-- Rekapitulasi Dropdown -->
     <div class="relative">
      <button id="rekapDropdownToggle"
        class="flex items-center w-full px-4 py-2 rounded hover:bg-green-800 transition text-left">
        <span class="material-icons mr-2">summarize</span>
        Rekapitulasi
        <span id="rekapDropdownArrow" class="material-icons ml-auto text-sm">expand_more</span>
      </button>
      <div id="rekapDropdownMenu" class="overflow-hidden transition-all duration-300 ease-in-out" style="max-height: 0px;">
        <div class="pl-6 mt-1 space-y-1">
          <a href="/aslab/rekap/pendaftar"
            class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition <%= activePage === 'rekapPendaftar' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
            Pendaftar
          </a>
          <a href="/aslab/rekap/absensi"
            class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition <%= activePage === 'rekapAbsensi' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
            Absensi
          </a>
          <a href="/aslab/rekap/kuisioner"
            class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition <%= activePage === 'rekapKuisioner' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
            Kuisioner
          </a>
          <a href="/aslab/rekap/kelulusan"
            class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition <%= activePage === 'rekapKelulusan' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
            Kelulusan
          </a>
        </div>
      </div>
    </div>
    
    <!-- Statistik -->
    <a href="/aslab/statistik"
       class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition
       <%= activePage === 'statistik' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
      <span class="material-icons mr-2">analytics</span>
      Statistik
    </a>

    <a href="/aslab/tugas"
       class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition
       <%= activePage === 'buatTugas' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
      <span class="material-icons mr-2">assignment</span>
      Penugasan
    </a>

    <!-- Penilaian Dropdown -->
    <div class="relative">
      <button id="penilaianDropdownToggle"
        class="flex items-center w-full px-4 py-2 rounded hover:bg-green-800 transition text-left">
        <span class="material-icons mr-2">fact_check</span>
        Penilaian
        <span id="penilaianDropdownArrow" class="material-icons ml-auto text-sm">expand_more</span>
      </button>
      <div id="penilaianDropdownMenu" class="overflow-hidden transition-all duration-300 ease-in-out"
        style="max-height: 0px;">
        <div class="pl-6 mt-1 space-y-1">
          <a href="/aslab/penilaianMagang"
            class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition <%= activePage === 'penilaianMagang' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
            Penilaian Magang
          </a>
          <a href="/aslab/penilaianTotal"
            class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition <%= activePage === 'penilaianTotal' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
            Penilaian Total
          </a>
        </div>
      </div>
    </div>


    <!-- Ranking -->
    <a href="/aslab/rankingMagang"
       class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition
       <%= activePage === 'ranking' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
      <span class="material-icons mr-2">leaderboard</span>
      Ranking
    </a>

    <!-- Pengumuman -->
    <a href="/aslab/pengumuman"
       class="flex items-center px-4 py-2 rounded hover:bg-green-800 transition
       <%= activePage === 'pengumuman' ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
      <span class="material-icons mr-2">campaign</span>
      Pengumuman
    </a>
  </nav>
</aside>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const activePage = "<%= typeof activePage !== 'undefined' ? activePage : '' %>";

    // Helper function to toggle dropdown
    function toggleDropdown(menu, arrow) {
      const isExpanded = menu.style.maxHeight !== '0px' && menu.style.maxHeight !== '';
      menu.style.maxHeight = isExpanded ? '0px' : menu.scrollHeight + 'px';
      if (arrow) {
        arrow.textContent = isExpanded ? 'expand_more' : 'expand_less';
      }
    }

    // --- Rekapitulasi Dropdown ---
    const rekapToggle = document.getElementById('rekapDropdownToggle');
    const rekapMenu = document.getElementById('rekapDropdownMenu');
    const rekapArrow = document.getElementById('rekapDropdownArrow');
    const rekapPages = ['rekapPendaftar', 'rekapAbsensi', 'rekapKuisioner', 'rekapKelulusan'];

    if (rekapToggle) {
      rekapToggle.addEventListener('click', (e) => {
        e.preventDefault();
        toggleDropdown(rekapMenu, rekapArrow);
      });
      if (rekapPages.includes(activePage)) {
        toggleDropdown(rekapMenu, rekapArrow);
      }
    }
    
    // --- Penilaian Dropdown ---
    const penilaianToggle = document.getElementById('penilaianDropdownToggle');
    const penilaianMenu = document.getElementById('penilaianDropdownMenu');
    const penilaianArrow = document.getElementById('penilaianDropdownArrow');
    const penilaianPages = ['penilaianMagang', 'penilaianTotal'];

    if (penilaianToggle) {
      penilaianToggle.addEventListener('click', (e) => {
        e.preventDefault();
        toggleDropdown(penilaianMenu, penilaianArrow);
      });
      if (penilaianPages.includes(activePage)) {
        toggleDropdown(penilaianMenu, penilaianArrow);
      }
    }

    // --- Close dropdowns when clicking outside ---
    document.addEventListener('click', function (event) {
      if (rekapToggle && !rekapToggle.contains(event.target) && !rekapMenu.contains(event.target)) {
        if (rekapMenu.style.maxHeight !== '0px') {
            rekapMenu.style.maxHeight = '0px';
            rekapArrow.textContent = 'expand_more';
        }
      }
      if (penilaianToggle && !penilaianToggle.contains(event.target) && !penilaianMenu.contains(event.target)) {
        if (penilaianMenu.style.maxHeight !== '0px') {
            penilaianMenu.style.maxHeight = '0px';
            penilaianArrow.textContent = 'expand_more';
        }
      }
    });
  });
</script>
