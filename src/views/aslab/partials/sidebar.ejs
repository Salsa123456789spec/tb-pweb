<aside class="w-64 min-h-screen bg-gradient-to-b from-green-700 to-green-900 text-white shadow-md">
  <div class="p-6 text-xl font-bold">
    LeasCalling
  </div>
  <nav class="px-4">
    <a href="/aslab/dashboard"
       class="block py-3 px-4 rounded transition
       <%= (typeof activePage !== 'undefined' && activePage === 'dashboard') ? 'bg-white bg-opacity-20 font-semibold' : 'hover:bg-white hover:bg-opacity-10' %>">
      <span class="material-icons mr-2 align-middle">dashboard</span>
      Dashboard
    </a>
    
    <a href="/aslab/absensi"
       class="block py-3 px-4 rounded transition
       <%= (typeof activePage !== 'undefined' && activePage === 'absensi') ? 'bg-white bg-opacity-20 font-semibold' : 'hover:bg-white hover:bg-opacity-10' %>">
      <span class="material-icons mr-2 align-middle">description</span>
      Absensi
    </a>
    
    <a href="/aslab/tugas"
       class="block py-3 px-4 rounded transition
       <%= (typeof activePage !== 'undefined' && activePage === 'tugas') ? 'bg-white bg-opacity-20 font-semibold' : 'hover:bg-white hover:bg-opacity-10' %>">
      <span class="material-icons mr-2 align-middle">assignment</span>
      Tugas
    </a>
    
    <a href="/aslab/materi"
       class="block py-3 px-4 rounded transition
       <%= (typeof activePage !== 'undefined' && activePage === 'materi') ? 'bg-white bg-opacity-20 font-semibold' : 'hover:bg-white hover:bg-opacity-10' %>">
      <span class="material-icons mr-2 align-middle">book</span>
      Materi
    </a>

    <div class="relative">
      <button id="rekapDropdownButton" class="block w-full text-left py-3 px-4 rounded transition hover:bg-white hover:bg-opacity-10 focus:outline-none
        <%= (typeof activePage !== 'undefined' && (activePage === 'rekapAbsensi' || activePage === 'rekapKelulusan' || activePage === 'rekapKuisioner' || activePage === 'rekapPendaftar')) ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
        <span class="material-icons mr-2 align-middle">folder</span>
        Rekap
        <span class="material-icons ml-auto text-sm">keyboard_arrow_down</span>
      </button>
      <div id="rekapDropdownMenu" class="hidden absolute left-0 mt-1 w-full bg-green-800 rounded shadow-lg z-10">
        <a href="/aslab/rekap/pendaftar"
           class="block py-2 px-6 rounded transition hover:bg-white hover:bg-opacity-10
           <%= (typeof activePage !== 'undefined' && activePage === 'rekapPendaftar') ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
          Pendaftar
        </a>
        <a href="/aslab/rekap/absensi"
           class="block py-2 px-6 rounded transition hover:bg-white hover:bg-opacity-10
           <%= (typeof activePage !== 'undefined' && activePage === 'rekapAbsensi') ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
          Absensi
        </a>
        <a href="/aslab/rekap/kelulusan"
           class="block py-2 px-6 rounded transition hover:bg-white hover:bg-opacity-10
           <%= (typeof activePage !== 'undefined' && activePage === 'rekapKelulusan') ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
          Kelulusan
        </a>
        <a href="/aslab/rekap/kuisioner"
           class="block py-2 px-6 rounded transition hover:bg-white hover:bg-opacity-10
           <%= (typeof activePage !== 'undefined' && activePage === 'rekapKuisioner') ? 'bg-white bg-opacity-20 font-semibold' : '' %>">
          Kuisioner
        </a>
      </div>
    </div>
  </nav>
</aside>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const rekapDropdownButton = document.getElementById('rekapDropdownButton');
    const rekapDropdownMenu = document.getElementById('rekapDropdownMenu');

    rekapDropdownButton.addEventListener('click', function() {
      rekapDropdownMenu.classList.toggle('hidden');
    });

    // Close the dropdown if the user clicks outside of it
    window.addEventListener('click', function(event) {
      if (!rekapDropdownButton.contains(event.target) && !rekapDropdownMenu.contains(event.target)) {
        rekapDropdownMenu.classList.add('hidden');
      }
    });

    // Keep "Rekap" active if any of its sub-items are active
    const currentPath = window.location.pathname;
    if (currentPath.startsWith('/aslab/rekap/')) {
        rekapDropdownMenu.classList.remove('hidden'); // Ensure dropdown is open if a sub-item is active
    }
  });
</script>