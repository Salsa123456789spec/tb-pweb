<h1 class="page-title">
    <i class="fas fa-chart-bar"></i> Rekap Pendaftar
</h1>

<% if(typeof success_msg !== 'undefined' && success_msg.length > 0) { %>
    <div class="alert alert-success" role="alert"><i class="fas fa-check-circle"></i> <%= success_msg %></div>
<% } %>
<% if(typeof error_msg !== 'undefined' && error_msg.length > 0) { %>
    <div class="alert alert-danger" role="alert"><i class="fas fa-times-circle"></i> <%= error_msg %></div>
<% } %>

<div class="card data-card">
    <h5 class="card-header bg-success text-white">
        <i class="fas fa-table"></i> Data Semua Pendaftar
    </h5>
    <div class="card-body">
        <div class="row mb-3">
            <div class="col-md-6">
                <form class="d-flex align-items-center">
                    <label for="entries-select" class="form-label me-2 mb-0">Tampilkan</label>
                    <select id="entries-select" class="form-select form-select-sm" style="width: auto;">
                        <option value="10" selected>10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                    <span class="ms-2">data</span>
                </form>
            </div>
            <div class="col-md-6">
                <form>
                    <div class="input-group">
                        <!-- Input pencarian diberi ID "searchInput" -->
                        <input type="text" id="searchInput" class="form-control" placeholder="Cari data pendaftar...">
                        <button class="btn btn-outline-success" type="button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="text-center">
                    <tr>
                        <th>NIM</th>
                        <th>Nama</th>
                        <th>No HP</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <!-- tbody diberi ID "pendaftarTableBody" -->
                <tbody id="pendaftarTableBody" class="text-center">
                    <% if (pendaftar && pendaftar.length > 0) { %>
                        <% pendaftar.forEach(p => { %>
                            <tr>
                                <td><%= p.nim %></td>
                                <td><%= p.nama %></td>
                                <td><%= p.no_hp %></td>
                                <td>
                                    <a href="/aslab/rekap/pendaftar/detail/<%= p.id %>" class="btn btn-info btn-sm" title="Lihat Detail">
                                        <i class="fas fa-eye"></i>
                                    </a>
                                    <a href="/aslab/rekap/pendaftar/delete/<%= p.id %>" class="btn btn-danger btn-sm" title="Hapus Data" onclick="return confirm('Yakin ingin menghapus data pendaftar ini?')">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </td>
                            </tr>
                        <% }); %>
                    <% } else { %>
                        <tr>
                            <td colspan="4" class="py-5 text-muted">
                                Tidak ada data pendaftar yang tersedia.
                            </td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
    <% if (pendaftar && pendaftar.length > 0) { %>
        <div class="card-footer d-flex justify-content-between align-items-center">
            <span class="text-muted small">Menampilkan 1 sampai <%= pendaftar.length %> dari <%= pendaftar.length %> data</span>
            <nav aria-label="Page navigation">
                <ul class="pagination pagination-sm mb-0">
                    <li class="page-item disabled"><a class="page-link" href="#">Sebelumnya</a></li>
                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">Selanjutnya</a></li>
                </ul>
            </nav>
        </div>
    <% } %>
</div>

<!-- Script untuk Fungsionalitas Pencarian Real-time -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('searchInput');
        const tableBody = document.getElementById('pendaftarTableBody');
        const rows = tableBody.getElementsByTagName('tr');

        searchInput.addEventListener('keyup', function(event) {
            const searchTerm = event.target.value.toLowerCase();

            // Loop melalui semua baris tabel
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const nimCell = row.cells[0]; // Kolom NIM
                const nameCell = row.cells[1]; // Kolom Nama

                if (nimCell && nameCell) {
                    const nimText = nimCell.textContent || nimCell.innerText;
                    const nameText = nameCell.textContent || nameCell.innerText;

                    // Cek jika NIM atau Nama mengandung kata kunci pencarian
                    if (nimText.toLowerCase().indexOf(searchTerm) > -1 || nameText.toLowerCase().indexOf(searchTerm) > -1) {
                        row.style.display = ""; // Tampilkan baris jika cocok
                    } else {
                        row.style.display = "none"; // Sembunyikan baris jika tidak cocok
                    }
                }
            }
        });
    });
</script>
