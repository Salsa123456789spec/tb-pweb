<div class="container mx-auto p-4">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">Penugasan</h1>
  <p class="text-gray-600 mb-8">
    Anda bisa melihat pembagian kelompok magang pada laman hasil seleksi wawancara atau bisa dengan mengklik 
    <a href="/mahasiswa/kelompok" class="text-blue-600 underline">disini</a>.
  </p>

  <% if (tugas.length > 0) { 
      const sudah = [];
      const belum = [];
      const terlambat = [];

      tugas.forEach(item => {
        const isExpired = new Date(item.deadline) < new Date();
        const sudahKumpul = dikumpulMap[item.id];

        if (sudahKumpul) {
          sudah.push({ ...item });
        } else if (isExpired) {
          terlambat.push({ ...item });
        } else {
          belum.push({ ...item });
        }
      });
  %>

    <!-- Tugas Belum Dikumpul -->
    <section class="mb-12 border-t border-b border-red-300 py-6">
      <h2 class="text-2xl font-semibold text-red-600 mb-6">📌 Tugas Belum Dikumpul</h2>
      <% if (belum.length > 0) { %>
        <div class="space-y-4">
          <% belum.forEach(item => { %>
            <div class="flex items-start justify-between bg-white border-l-4 border-red-500 shadow-sm p-5 rounded-md">
              <div>
                <h3 class="text-lg font-semibold text-gray-800"><%= item.judul %></h3>
                <p class="text-sm text-gray-600 mb-2">
                  Tenggat: <%= new Date(item.deadline).toLocaleDateString('id-ID', {
                    day: 'numeric', month: 'long', year: 'numeric'
                  }) %>
                </p>
              </div>
              <div class="flex items-center gap-4">
                <span class="bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full">Belum Dikumpul</span>
                <a href="/mahasiswa/tugas/<%= item.id %>" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition">
                  Detail
                </a>
              </div>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <p class="text-gray-600">Tidak ada tugas yang belum dikumpulkan.</p>
      <% } %>
    </section>

    <!-- Tugas Terlambat -->
    <section class="mb-12 border-t border-b border-gray-300 py-6">
      <h2 class="text-2xl font-semibold text-gray-700 mb-6">⏰ Tugas Terlambat</h2>
      <% if (terlambat.length > 0) { %>
        <div class="space-y-4">
          <% terlambat.forEach(item => { %>
            <div class="flex items-start justify-between bg-white border-l-4 border-gray-500 shadow-sm p-5 rounded-md">
              <div>
                <h3 class="text-lg font-semibold text-gray-800"><%= item.judul %></h3>
                <p class="text-sm text-gray-600 mb-2">
                  Tenggat: <%= new Date(item.deadline).toLocaleDateString('id-ID', {
                    day: 'numeric', month: 'long', year: 'numeric'
                  }) %>
                </p>
              </div>
              <div class="flex items-center gap-4">
                <span class="bg-gray-600 text-white text-xs font-bold px-3 py-1 rounded-full">Terlambat</span>
                <a href="/mahasiswa/tugas/<%= item.id %>" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition">
                  Detail
                </a>
              </div>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <p class="text-gray-600">Tidak ada tugas yang terlambat dikumpulkan.</p>
      <% } %>
    </section>

    <!-- Tugas Sudah Dikumpul -->
    <section class="mb-12 border-t border-b border-green-300 py-6">
      <h2 class="text-2xl font-semibold text-green-600 mb-6">✅ Tugas Sudah Dikumpul</h2>
      <% if (sudah.length > 0) { %>
        <div class="space-y-4">
          <% sudah.forEach(item => { %>
            <div class="flex items-start justify-between bg-white border-l-4 border-green-500 shadow-sm p-5 rounded-md">
              <div>
                <h3 class="text-lg font-semibold text-gray-800"><%= item.judul %></h3>
                <p class="text-sm text-gray-600 mb-2">
                  Tenggat: <%= new Date(item.deadline).toLocaleDateString('id-ID', {
                    day: 'numeric', month: 'long', year: 'numeric'
                  }) %>
                </p>
              </div>
              <div class="flex items-center gap-4">
                <span class="bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full">Terkumpul</span>
                <a href="/mahasiswa/tugas/<%= item.id %>" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition">
                  Detail
                </a>
              </div>
            </div>
          <% }) %>
        </div>
      <% } else { %>
        <p class="text-gray-600">Belum ada tugas yang dikumpulkan.</p>
      <% } %>
    </section>

  <% } else { %>
    <p class="text-gray-600">Belum ada tugas yang tersedia saat ini.</p>
  <% } %>
</div>
